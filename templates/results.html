<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <title>Entity Recognition Results</title>
  </head>
  <body>
    <div class="container">
      <h1 class="mt-5">Entity Recognition Results</h1>
      <button id="sortButton" class="btn btn-primary mt-3">Sort by Category</button>
      <table id="resultsTable" class="table table-bordered mt-3">
        <thead>
          <tr>
            <th>Text</th>
            <th>Entity</th>
            <th>Category</th>
            <th>Confidence Score</th>
          </tr>
        </thead>
        <tbody>
          {% for result in entity_results %}
            {% for entity in result.entities %}
              <tr>
                <td>{{ result.text }}</td>
                <td>{{ entity.text }}</td>
                <td>{{ entity.category }}</td>
                <td>{{ entity.confidence_score }}</td>
              </tr>
            {% endfor %}
          {% endfor %}
        </tbody>
      </table>
      <a href="/" class="btn btn-primary mt-3">Go Back</a>
    </div>
    <script>
      // JavaScript to sort the table by category
      document.getElementById('sortButton').addEventListener('click', function() {
        let table = document.getElementById('resultsTable').getElementsByTagName('tbody')[0];
        let rows = Array.from(table.rows);

        rows.sort((a, b) => {
          let categoryA = a.cells[2].innerText;
          let categoryB = b.cells[2].innerText;
          return categoryA.localeCompare(categoryB);
        });

        // Reattach sorted rows to the table body
        rows.forEach(row => table.appendChild(row));
      });
    </script>
  </body>
</html>
