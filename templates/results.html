<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <title>Entity Recognition Results</title>
  </head>
  <body>
    <div class="container">
      <h1 class="mt-5">Entity Recognition Results</h1>
      <table class="table table-bordered mt-3">
        <thead>
          <tr>
            <th>Text</th>
            <th>Entities</th>
            <th>Category</th>
            <th>Confidence Scores</th>
          </tr>
        </thead>
        <tbody>
          {% for result in entity_results %}
            {% set category_dict = {} %}
            {% for entity in result.entities %}
              {% set category = entity.category %}
              {% if category not in category_dict %}
                {% set category_dict = category_dict.update({category: []}) %}
              {% endif %}
              {% set category_dict = category_dict.update({category: category_dict[category] + [(entity.text, entity.confidence_score)]}) %}
            {% endfor %}
            {% for category, entities in category_dict.items() %}
              <tr>
                <td>{{ result.text }}</td>
                <td>
                  {% for entity in entities %}
                    {{ entity[0] }}{% if not loop.last %}, {% endif %}
                  {% endfor %}
                </td>
                <td>{{ category }}</td>
                <td>
                  {% for entity in entities %}
                    {{ entity[1] }}{% if not loop.last %}, {% endif %}
                  {% endfor %}
                </td>
              </tr>
            {% endfor %}
          {% endfor %}
        </tbody>
      </table>
      <a href="/" class="btn btn-primary mt-3">Go Back</a>
    </div>
  </body>
</html>
